using Squirrel.Wiki.Core.Models;

namespace Squirrel.Wiki.Core.Services;

/// <summary>
/// Service interface for page management operations
/// </summary>
public interface IPageService
{
    // Page CRUD operations
    Task<PageDto> GetByIdAsync(int id, CancellationToken cancellationToken = default);
    Task<PageDto?> GetBySlugAsync(string slug, CancellationToken cancellationToken = default);
    Task<PageDto?> GetByTitleAsync(string title, CancellationToken cancellationToken = default);
    Task<IEnumerable<PageDto>> GetAllAsync(CancellationToken cancellationToken = default);
    Task<IEnumerable<PageDto>> GetByCategoryAsync(int categoryId, CancellationToken cancellationToken = default);
    Task<IEnumerable<PageDto>> GetByTagAsync(string tag, CancellationToken cancellationToken = default);
    Task<IEnumerable<PageDto>> GetByAuthorAsync(string username, CancellationToken cancellationToken = default);
    
    Task<PageDto> CreateAsync(PageCreateDto createDto, string username, CancellationToken cancellationToken = default);
    Task<PageDto> UpdateAsync(int id, PageUpdateDto updateDto, string username, CancellationToken cancellationToken = default);
    Task DeleteAsync(int id, CancellationToken cancellationToken = default);
    Task<PageDto> RestoreAsync(int id, CancellationToken cancellationToken = default);
    
    // Content and versioning
    Task<PageContentDto> GetLatestContentAsync(int pageId, CancellationToken cancellationToken = default);
    Task<IEnumerable<PageContentDto>> GetContentHistoryAsync(int pageId, CancellationToken cancellationToken = default);
    Task<PageContentDto?> GetContentByVersionAsync(int pageId, int version, CancellationToken cancellationToken = default);
    Task<PageDto> RevertToVersionAsync(int pageId, int version, string username, CancellationToken cancellationToken = default);
    
    // Rendering
    Task<string> RenderContentAsync(string markdownContent, CancellationToken cancellationToken = default);
    Task<string> RenderPageAsync(int pageId, CancellationToken cancellationToken = default);
    
    // Slug generation
    Task<string> GenerateSlugAsync(string title, int? excludePageId = null, CancellationToken cancellationToken = default);
    
    // Search
    Task<IEnumerable<PageDto>> SearchAsync(string query, CancellationToken cancellationToken = default);
    
    // Homepage
    Task<PageDto?> GetHomePageAsync(CancellationToken cancellationToken = default);
    
    // Helper methods for controllers
    Task<IEnumerable<TagDto>> GetPageTagsAsync(int pageId, CancellationToken cancellationToken = default);
    Task<CategoryDto?> GetCategoryAsync(int categoryId, CancellationToken cancellationToken = default);
}
