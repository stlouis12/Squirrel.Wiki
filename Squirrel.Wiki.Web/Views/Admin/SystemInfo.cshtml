@model dynamic
@{
    ViewData["Title"] = Localizer["SystemInformation"].Value;
}

<div class="container-fluid mt-4">
    <div class="row mb-4">
        <div class="col">
            <h1><i class="bi bi-info-circle"></i> @Localizer["SystemInformation"]</h1>
            <p class="text-muted">@Localizer["DetailedSystemInfo"]</p>
        </div>
        <div class="col-auto">
            <a asp-action="Index" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> @Localizer["BackToDashboard"]
            </a>
        </div>
    </div>

    <!-- Environment Information -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="bi bi-server"></i> @Localizer["EnvironmentInformation"]</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <tbody>
                                <tr>
                                    <th style="width: 30%;">@Localizer["MachineName"]</th>
                                    <td>@Model.Environment.MachineName</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["OperatingSystem"]</th>
                                    <td>@Model.Environment.OSVersion</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["ProcessorCount"]</th>
                                    <td>@Model.Environment.ProcessorCount @Localizer["Cores"]</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["64BitOperatingSystem"]</th>
                                    <td>
                                        @if (Model.Environment.Is64BitOperatingSystem)
                                        {
                                            <span class="badge bg-success">@Localizer["Yes"]</span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-warning">@Localizer["No32Bit"]</span>
                                        }
                                    </td>
                                </tr>
                                <tr>
                                    <th>@Localizer["64BitProcess"]</th>
                                    <td>
                                        @if (Model.Environment.Is64BitProcess)
                                        {
                                            <span class="badge bg-success">@Localizer["Yes"]</span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-warning">@Localizer["No32Bit"]</span>
                                        }
                                    </td>
                                </tr>
                                <tr>
                                    <th>@Localizer["DotNetRuntimeVersion"]</th>
                                    <td>@Model.Environment.RuntimeVersion</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["WorkingSetMemory"]</th>
                                    <td>@((Model.Environment.WorkingSet / 1024 / 1024).ToString("N0")) MB</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["SystemPageSize"]</th>
                                    <td>@Model.Environment.SystemPageSize @Localizer["Bytes"]</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Application Information -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0"><i class="bi bi-app-indicator"></i> @Localizer["ApplicationInformation"]</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <tbody>
                                <tr>
                                    <th style="width: 30%;">@Localizer["ApplicationName"]</th>
                                    <td>Squirrel Wiki</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["Version"]</th>
                                    <td>
                                        <span class="badge bg-primary">@Model.Application.Version</span>
                                    </td>
                                </tr>
                                <tr>
                                    <th>@Localizer["Framework"]</th>
                                    <td>@Model.Application.Framework</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["StartTime"]</th>
                                    <td>@Model.Application.StartTime.ToString("F")</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["Uptime"]</th>
                                    <td>
                                        @{
                                            var uptime = (TimeSpan)Model.Application.Uptime;
                                            if (uptime.TotalDays >= 1)
                                            {
                                                <span class="badge bg-success">@uptime.Days @Localizer["Days"], @uptime.Hours @Localizer["Hours"], @uptime.Minutes @Localizer["Minutes"]</span>
                                            }
                                            else if (uptime.TotalHours >= 1)
                                            {
                                                <span class="badge bg-info">@uptime.Hours @Localizer["Hours"], @uptime.Minutes @Localizer["Minutes"]</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-secondary">@uptime.Minutes @Localizer["Minutes"], @uptime.Seconds @Localizer["Seconds"]</span>
                                            }
                                        }
                                    </td>
                                </tr>
                                <tr>
                                    <th>@Localizer["CurrentUser"]</th>
                                    <td>@User.Identity?.Name</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["UserRole"]</th>
                                    <td>
                                        @if (User.IsInRole(ADMIN_ROLE))
                                        {
                                            <span class="badge bg-danger">@Localizer["Admin"]</span>
                                        }
                                        else if (User.IsInRole(EDITOR_ROLE))
                                        {
                                            <span class="badge bg-warning">@Localizer["Editor"]</span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-secondary">@Localizer["Viewer"]</span>
                                        }
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Configuration Information -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0"><i class="bi bi-gear"></i> @Localizer["Configuration"]</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <tbody>
                                <tr>
                                    <th style="width: 30%;">@Localizer["Environment"]</th>
                                    <td>
                                        @{
                                            var env = Context.RequestServices.GetRequiredService<IWebHostEnvironment>();
                                            if (env.IsDevelopment())
                                            {
                                                <span class="badge bg-warning">@Localizer["Development"]</span>
                                            }
                                            else if (env.IsStaging())
                                            {
                                                <span class="badge bg-info">@Localizer["Staging"]</span>
                                            }
                                            else if (env.IsProduction())
                                            {
                                                <span class="badge bg-success">@Localizer["Production"]</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-secondary">@env.EnvironmentName</span>
                                            }
                                        }
                                    </td>
                                </tr>
                                <tr>
                                    <th>@Localizer["WebRootPath"]</th>
                                    <td><code>@env.WebRootPath</code></td>
                                </tr>
                                <tr>
                                    <th>@Localizer["ApplicationName"]</th>
                                    <td>@env.ApplicationName</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Request Information -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0"><i class="bi bi-globe"></i> @Localizer["CurrentRequest"]</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <tbody>
                                <tr>
                                    <th>@Localizer["RequestMethod"]</th>
                                    <td><span class="badge bg-primary">@Context.Request.Method</span></td>
                                </tr>
                                <tr>
                                    <th>@Localizer["Protocol"]</th>
                                    <td>@Context.Request.Protocol</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["ContentType"]</th>
                                    <td>@(Context.Request.ContentType ?? "N/A")</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["RemoteIPAddress"]</th>
                                    <td>@Context.Connection.RemoteIpAddress</td>
                                </tr>
                                <tr>
                                    <th>@Localizer["UserAgent"]</th>
                                    <td><small>@Context.Request.Headers["User-Agent"]</small></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
